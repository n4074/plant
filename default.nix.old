let
  config = {
    packageOverrides = pkgs: rec {
      haskell = pkgs.haskell // {
        packages = pkgs.haskell.packages // {
          ghc844 = pkgs.haskell.packages.ghc844 // {
            ghc = pkgs.haskell.packages.ghc844.ghc.override {
              enableRelocatedStaticLibs = true; 
            };
          };
        };
      };
    };
  };

  pkgs = import <nixpkgs> { inherit config; };

in 
pkgs.haskell.packages.ghc844.extend (
  pkgs.haskell.lib.packageSourceOverrides {
    plant-core = ./plant-core;
    plant-module = ./plant-module;
    ghc-hotswap = ./ghc-hotswap;
  }
)
